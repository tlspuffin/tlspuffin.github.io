"use strict";(self.webpackChunktlspuffin_website=self.webpackChunktlspuffin_website||[]).push([[8060],{3217:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var n=s(4848),i=s(8453);const r={title:"Fuzzing OpenSSL"},a=void 0,l={id:"guides/getting-started/fuzzing-openssl",title:"Fuzzing OpenSSL",description:"Building the Fuzzer",source:"@site/docs/guides/getting-started/fuzzing-openssl.md",sourceDirName:"guides/getting-started",slug:"/guides/getting-started/fuzzing-openssl",permalink:"/docs/guides/getting-started/fuzzing-openssl",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Fuzzing OpenSSL"},sidebar:"docs",previous:{title:"Building OpenSSL",permalink:"/docs/guides/getting-started/building-openssl"},next:{title:"Replaying Traces",permalink:"/docs/guides/getting-started/replaying-traces"}},o={},d=[{value:"Building the Fuzzer",id:"building-the-fuzzer",level:2},{value:"Generating Seeds",id:"generating-seeds",level:2},{value:"Running the Fuzzer",id:"running-the-fuzzer",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"building-the-fuzzer",children:"Building the Fuzzer"}),"\n",(0,n.jsx)(t.p,{children:"Now that we have the OpenSSL library to serve as a fuzz target, we can create the corresponding fuzzer:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"cargo build --release --bin=tlspuffin --features=cputs\n"})}),"\n",(0,n.jsxs)(t.p,{children:["By setting ",(0,n.jsx)(t.code,{children:"--cputs"}),", the build process will automatically select all the fuzz targets located in ",(0,n.jsx)(t.code,{children:"./vendor/"}),"; a specific fuzz target can then be selected at runtime (see below).\nThe build process creates the fuzzer at ",(0,n.jsx)(t.code,{children:"./target/release/tlspuffin"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["Use different features with ",(0,n.jsx)(t.code,{children:"--features"})," for other targets (see  ",(0,n.jsx)(t.a,{href:"../../references/support-matrix",children:"support matrix"}),".)"]}),"\n",(0,n.jsx)(t.h2,{id:"generating-seeds",children:"Generating Seeds"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.em,{children:"tlspuffin"})," comes with a set of standard seeds for TLS (handshake, session resumption, ...) that can serve as the initial corpus for the fuzzing process, rather than letting the fuzzer rediscover the details of the TLS protocol."]}),"\n",(0,n.jsxs)(t.p,{children:["You can generate the seeds compatible with the selected fuzz target in the ",(0,n.jsx)(t.code,{children:"./seeds"})," folder by running:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"./target/release/tlspuffin seed\n"})}),"\n",(0,n.jsx)(t.h2,{id:"running-the-fuzzer",children:"Running the Fuzzer"}),"\n",(0,n.jsxs)(t.p,{children:["We are finally ready to launch the fuzzer against a specific fuzz target (in this case ",(0,n.jsx)(t.code,{children:"openssl312-asan"}),"):"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"./target/release/tlspuffin --put openssl312-asan --cores=0-3 --tui quick-experiment\n"})}),"\n",(0,n.jsxs)(t.p,{children:["This creates a folder ",(0,n.jsx)(t.code,{children:"experiments/<id>"})," containing the results of the fuzzing run.\nIn particular, the folder ",(0,n.jsx)(t.code,{children:"experiments/<id>/corpus"})," will store the corpus found during the fuzzing session and the folder ",(0,n.jsx)(t.code,{children:"experiments/<id>/objectives"})," will store the objectives (i.e., attack traces) found during the fuzzing session."]}),"\n",(0,n.jsxs)(t.p,{children:["In case the port is already in use, you can specify a different port using the ",(0,n.jsx)(t.code,{children:"--port"})," option.\nThe option ",(0,n.jsx)(t.code,{children:"--cores"})," allows to specify the cores to use for the fuzzing process, by setting high affinity values to those cores.\nUse ",(0,n.jsx)(t.code,{children:"./target/release/tlspuffin --help"})," to get a list of all available options."]}),"\n",(0,n.jsx)(t.admonition,{title:"What are these .trace files in my corpus folder?",type:"tip",children:(0,n.jsxs)(t.p,{children:["Because ",(0,n.jsx)(t.em,{children:"tlspuffin"})," works at a higher level of abstraction compared to generic fuzzers, the corpus files are not raw inputs for a binary but rather traces of the protocol session between different agents. More details in the next section!"]})})]})}function u(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}}}]);